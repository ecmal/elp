{
  "version": 3,
  "file": "command.js",
  "sourceRoot": "/Users/Sergey/Work/GH/ecmal/elp/src",
  "sources": [
    "command.ts"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "const process = system.node.process;\n\nconst OPTIONS:symbol = Symbol();\nconst COMMAND:symbol = Symbol();\nconst COMMANDS = [];\n\nexport function Option(settings?):any{\n    return (target:any,key:string) => {\n        if(!settings.name){\n            settings.name = key;\n        }\n        var options = target.constructor[OPTIONS];\n        if(!options){\n            options = target.constructor[OPTIONS] = {};\n        }\n        options[key] = settings;\n    }\n}\nexport function Command(settings?):any{\n    if(!settings){\n        settings = {};\n    }\n    return target=>{\n        if(!settings.name){\n            settings.name = String(target.class.name)\n                .replace(/([A-Z])/g,a=>'-'+a)\n                .toLowerCase()\n                .replace(/\\-(.*)/,'$1');\n        }\n        settings.options = target[OPTIONS]||{};\n        delete target[OPTIONS];\n\n        var parent = target.prototype.__proto__.constructor[COMMAND];\n        if(parent && parent.options){\n            for(var i in parent.options){\n                if(!settings.options[i]){\n                    settings.options[i] = parent.options[i]\n                }\n            }\n        }\n        target[COMMAND] = settings;\n        if(target.class.name!='Cli'){\n            COMMANDS.push(target);\n        }\n    }\n}\n\n@Command()\nexport class Cli {\n    static title:string;\n    static version:string;\n\n    static help(){\n        var meta = this[COMMAND];\n        var options = Object.keys(meta.options).map((option:any)=>{\n            option = meta.options[option];\n            return `  -\\033[1m${option.alias}\\033[0m, --\\033[1m${option.name}\\033[0m : ${option.title}`;\n        });\n        var commands = this!=Cli?[]:COMMANDS.map(c=>c[COMMAND]).map(command=>{\n            return `   \\033[1m${command.name}\\033[0m : ${command.title}`;\n        });\n        var head = [],parent = (<any>this.prototype).__proto__.constructor[COMMAND];\n        if(parent){\n            head.push(parent.name);\n        }\n        head.push(meta.name);\n        if(options.length){\n            head.push('[options]')\n        }\n        if(commands.length){\n            head.push('<command>')\n        }else\n        if(meta.args){\n            head.push(meta.args)\n        }\n        var help = ['',head.join(' ')];\n        if(options.length){\n            help.push('');\n            help.push('Options : ');\n            help.push(...options);\n        }\n        if(commands.length){\n            help.push('');\n            help.push('Commands : ');\n            help.push(...commands);\n        }\n        if(meta.usage){\n            if(Array.isArray(meta.usage)){\n                meta.usage = meta.usage.join('\\n');\n            }\n            help.push('');\n            help.push(meta.usage.split('\\n')\n                .filter(l=>!!l)\n                .map(l=>l.replace(/(\\s+\\|?)(.*)/,'$2'))\n                .join('\\n')\n            );\n        }\n        help.push('');\n        return help.join('\\n');\n    }\n\n    @Option({\n        alias    : 'h',\n        title    : 'Print help'\n    })\n    help:boolean=false;\n\n    @Option({\n        alias    : 'v',\n        required : true,\n        title    : 'Print version'\n    })\n    version:boolean=false;\n\n    protected cwd:string;\n\n    execute(...args){\n        if(this.version){\n            console.info(`${Cli.title} ${Cli.version}`);\n        } else\n        if(this.help){\n            var Class:any = this.constructor;\n            console.info(Class.help(Class));\n        }\n    }\n}\nexport default (name,version)=>{\n    process.title = name;\n    Cli.title = name;\n    Cli.version = version;\n    Cli[COMMAND].name = name;\n    var Command:any=Cli,args = process.argv.slice(2);\n    for(var i=0;i<args.length&&Command==Cli;i++){\n        var arg = args[i];\n        if(arg[0]!='-') {\n            for (var c = 0; c < COMMANDS.length; c++) {\n                if (COMMANDS[c][COMMAND].name == arg) {\n                    args[i] = null;\n                    Command = COMMANDS[c];\n                }\n            }\n        }\n    }\n    var meta = Command[COMMAND];\n    var metaOptions = (options=>{\n        var map = {};\n        for(var o in options){\n            var option = options[o];\n            map[option.name] = option;\n            map[option.alias] = option;\n        }\n        return map;\n    })(meta.options);\n\n    var cmd=new Command(),params=[];\n    for(var i=0;i<args.length;i++) {\n        var key,metaOption,val,arg = args[i];\n        if(arg) {\n            if (arg[0] == '-') {\n                if (arg[1] == '-') {\n                    key = arg.substring(2);\n                } else {\n                    key = arg[1];\n                }\n                metaOption = metaOptions[key];\n                if (metaOption) {\n                    if (metaOption.args) {\n                        if (arg[1] == '-') {\n                            val = args[++i];\n                        } else {\n                            if (arg.length > 2) {\n                                val = arg.substring(2);\n                            } else {\n                                val = args[++i]\n                            }\n                        }\n                    } else {\n                        val = true;\n                    }\n                    cmd[metaOption.name] = val;\n                } else {\n                    console.info('invalid option ' + arg);\n                }\n            } else {\n                params.push(arg);\n            }\n        }\n    }\n    cmd.cwd = process.cwd();\n    if(cmd.version || cmd.help){\n        Cli.prototype.execute.call(cmd);\n    }else{\n        cmd.execute(...params);\n    }\n};"
  ]
}